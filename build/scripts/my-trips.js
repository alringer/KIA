"use strict";$(document).ready(function(){window.myTrips={elements:{trip:$(".trip"),trip_collapse:$(".trip .collapse"),badge_input:$(".trip .badge input"),badge_cancel:$(".trip .badge em")},methods:{_toggle:function e(){var t=$(this),a=t.find(".collapse");t.hasClass("active")||(window.myTrips.elements.trip_collapse.collapse("hide"),window.myTrips.elements.trip.removeClass("active"),t.addClass("active"),a.collapse("show"))},tags:{_add:function e(){window.myTrips.methods.tags._save();var t=$(this),a=t.parents(".badge");a.addClass("adding"),a.parents(".trip-tags").addClass("focused")},_keyup:function e(t){var a=$(this),n=a.parents(".badge"),s=n.find("span"),i=a.val();if(32===t.keyCode)return void t.preventDefault();i.length>30&&(i=i.substr(0,30),a.val(i)),s.text(i.toLowerCase());var d=this;setTimeout(function(){d.selectionStart=d.selectionEnd=1e4},0),13===t.keyCode&&window.myTrips.methods.tags._save(),t.keyCode},_cancel:function e(){var t=$(this),a=t.parents(".badge");window.myTrips.methods.tags._cancel_element(a)},_cancel_element:function e(t,a){var n=t.find("input"),s=t.find("span"),i=t.parents(".trip-tags").find(".badge"),d=i.index(t);n.val(""),s.text(""),t.removeClass("adding"),t.parents(".trip-tags").removeClass("focused"),n.blur(),i.length>1&&d<i.length-1&&!a&&t.addClass("remove")},_save:function e(){var t=$(".trip.active"),a=t.find(".badge.adding"),n=a.find("span"),s=a.find("input"),i=a.parents(".trip-tags").find(".badge"),d=i.index(a);if(s.blur(),console.log("saving"),n.text().length){if(a.removeClass("add adding"),d===i.length-1)var p='<span class="badge add">\n                    <span></span>\n                    <input type="text" name="" value="" tabindex="-1">\n                    <em>+</em>\n                  </span>';$(p).appendTo(t.find(".trip-tags")).find("input")}else window.myTrips.methods.tags._cancel_element(a)}}}},window.myTrips.elements.trip.on("click",window.myTrips.methods._toggle),$("body").delegate(".trip .badge input","focus",window.myTrips.methods.tags._add),$("body").delegate(".trip .badge input","change paste keyup keydown",window.myTrips.methods.tags._keyup),$("body").delegate(".trip .badge em","click",window.myTrips.methods.tags._cancel)});