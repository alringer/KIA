"use strict";$(document).ready(function(){window.myTrips={elements:{view:$(".my-trips-page-view"),trip:$(".trip"),trip_collapse:$(".trip .collapse"),badge_input:$(".trip .badge input"),badge_cancel:$(".trip .badge em"),trip_list_scroll:$(".trips-list-inner"),scroll_top:$(".scroll-top"),stop_propagation:$(".stop-propagation"),start_edit:$(".start-edit"),stop_edit:$(".stop-edit"),toggle_edit:$(".toggle-edit"),trip_checkboxes:$(".trip .checkbox input"),merge_buttons_wrap:$(".merge-toggle"),merge:$(".merge-toggle .merge"),unmerge:$(".merge-toggle .unmerge"),delete:$(".edit-toolbar .delete"),select_all:$(".select-all")},methods:{_stop_prop:function e(t){t.stopPropagation()},_toggle:function e(){var t=$(this),s=t.find(".collapse");t.hasClass("active")||(window.myTrips.elements.trip_collapse.collapse("hide"),window.myTrips.elements.trip.removeClass("active"),t.addClass("active"),s.collapse("show"))},tags:{_add:function e(){window.myTrips.methods.tags._save();var t=$(this),s=t.parents(".badge");s.addClass("adding"),s.parents(".trip-tags").addClass("focused")},_keyup:function e(t){var s=$(this),i=s.parents(".badge"),n=i.find("span"),o=s.val();if(32===t.keyCode)return void t.preventDefault();o.length>30&&(o=o.substr(0,30),s.val(o)),n.text(o.toLowerCase());var d=this;setTimeout(function(){d.selectionStart=d.selectionEnd=1e4},0),13===t.keyCode&&window.myTrips.methods.tags._save(),t.keyCode},_cancel:function e(){var t=$(this),s=t.parents(".badge");window.myTrips.methods.tags._cancel_element(s)},_cancel_element:function e(t,s){var i=t.find("input"),n=t.find("span"),o=t.parents(".trip-tags").find(".badge"),d=o.index(t);i.val(""),n.text(""),t.removeClass("adding"),t.parents(".trip-tags").removeClass("focused"),i.blur(),o.length>1&&d<o.length-1&&!s&&t.addClass("remove")},_save:function e(){var t=$(".trip.active"),s=t.find(".badge.adding"),i=s.find("span"),n=s.find("input"),o=s.parents(".trip-tags").find(".badge"),d=o.index(s);if(n.blur(),console.log("saving"),i.text().length){if(s.removeClass("add adding"),d===o.length-1)var r='<span class="badge add">\n                    <span></span>\n                    <input type="text" name="" value="" tabindex="-1">\n                    <em>+</em>\n                  </span>';$(r).appendTo(t.find(".trip-tags")).find("input")}else window.myTrips.methods.tags._cancel_element(s)}},scroll:{onscroll:function e(t){window.myTrips.elements.trip_list_scroll.scrollTop()>10?window.myTrips.elements.trip_list_scroll.addClass("scrolled"):window.myTrips.elements.trip_list_scroll.removeClass("scrolled")},scrolltop:function e(t){window.myTrips.elements.trip_list_scroll.scrollTop(0)}},edit:{_start:function e(){window.myTrips.elements.view.addClass("editing")},_stop:function e(){window.myTrips.elements.view.removeClass("editing"),window.myTrips.elements.trip_checkboxes.prop("checked",!1),window.myTrips.elements.select_all.prop("checked",!1)},_checkbox_change:function e(){var t=window.myTrips.elements.trip_checkboxes.filter(":checked");t.length>1?window.myTrips.elements.merge_buttons_wrap.removeClass("disabled"):window.myTrips.elements.merge_buttons_wrap.addClass("disabled"),t.length?window.myTrips.elements.delete.removeClass("disabled"):window.myTrips.elements.delete.addClass("disabled");var s=!0;1===t.length&&t.parents(".trip.merged").length&&(window.myTrips.elements.merge_buttons_wrap.removeClass("disabled"),s=!1);var i=window.myTrips.elements.merge_buttons_wrap.find("span");i.removeClass("active"),s?i.filter(".merge").addClass("active"):i.filter(".unmerge").addClass("active")},_merge:function e(){var t=window.myTrips.elements.trip_checkboxes.filter(":checked").parents(".trip");t.addClass("merged"),t.not(".active").each(function(){var e=$(this);e.css("height",e.outerHeight()),setTimeout(function(){e.addClass("hide-trip")},10)}),window.myTrips.elements.trip_checkboxes.prop("checked",!1),window.myTrips.methods.edit._checkbox_change()},_delete:function e(){window.myTrips.elements.trip_checkboxes.filter(":checked").parents(".trip").each(function(){var e=$(this);e.css("height",e.outerHeight()),setTimeout(function(){e.addClass("hide-trip")},10)}),window.myTrips.elements.trip_checkboxes.prop("checked",!1),window.myTrips.methods.edit._checkbox_change()},_unmerge:function e(){var t=window.myTrips.elements.trip;t.removeClass("merged hide-trip"),setTimeout(function(){t.css("height","auto")},550),window.myTrips.methods.edit._checkbox_change()},_select_all:function e(){var t=$(this),s=t.prop("checked");window.myTrips.elements.select_all.prop("checked",s),window.myTrips.elements.trip_checkboxes.each(function(){var e=$(this);e.parents(".trip").hasClass("hide-trip")||e.prop("checked",s)}),window.myTrips.methods.edit._checkbox_change()}}}},window.myTrips.elements.trip.on("click",window.myTrips.methods._toggle),$("body").delegate(".trip .badge input","focus",window.myTrips.methods.tags._add),$("body").delegate(".trip .badge input","change paste keyup keydown",window.myTrips.methods.tags._keyup),$("body").delegate(".trip .badge em","click",window.myTrips.methods.tags._cancel),window.myTrips.elements.trip_list_scroll.on("scroll",window.myTrips.methods.scroll.onscroll),window.myTrips.elements.scroll_top.on("click",window.myTrips.methods.scroll.scrolltop),window.myTrips.elements.stop_propagation.on("click",window.myTrips.methods._stop_prop),window.myTrips.elements.start_edit.on("click",window.myTrips.methods.edit._start),window.myTrips.elements.stop_edit.on("click",window.myTrips.methods.edit._stop),window.myTrips.elements.trip_checkboxes.on("change",window.myTrips.methods.edit._checkbox_change),window.myTrips.elements.merge.on("click",window.myTrips.methods.edit._merge),window.myTrips.elements.unmerge.on("click",window.myTrips.methods.edit._unmerge),window.myTrips.elements.delete.on("click",window.myTrips.methods.edit._delete),window.myTrips.elements.select_all.on("change",window.myTrips.methods.edit._select_all),console.log(window.myTrips.elements.select_all.length)});