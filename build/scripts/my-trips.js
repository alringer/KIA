"use strict";$(document).ready(function(){window.myTrips={elements:{trip:$(".trip"),trip_collapse:$(".trip .collapse"),badge_input:$(".trip .badge input"),badge_cancel:$(".trip .badge em")},methods:{_toggle:function e(){var t=$(this),a=t.find(".collapse");t.hasClass("active")||(window.myTrips.elements.trip_collapse.collapse("hide"),window.myTrips.elements.trip.removeClass("active"),t.addClass("active"),a.collapse("show"))},tags:{_add:function e(){var t=$(this),a=t.parents(".badge");a.addClass("adding"),a.parents(".trip-tags").addClass("focused")},_keyup:function e(t){var a=$(this),n=a.parents(".badge"),s=n.find("span"),i=a.val();if(32===t.keyCode)return void t.preventDefault();i.length>30&&(i=i.substr(0,30),a.val(i)),s.text(i.toLowerCase());var d=this;setTimeout(function(){d.selectionStart=d.selectionEnd=1e4},0),13===t.keyCode&&window.myTrips.methods.tags._save(),27===t.keyCode&&window.myTrips.methods.tags._cancel_element(a)},_cancel:function e(){var t=$(this);window.myTrips.methods.tags._cancel_element(t)},_cancel_element:function e(t){var a=t.parents(".badge"),n=a.find("input"),s=a.find("span");n.val(""),s.text(""),a.removeClass("adding"),a.parents(".trip-tags").removeClass("focused"),n.blur()},_save:function e(){var t=$(".trip.active"),a=t.find(".badge.adding");a.find("span").text().length?(a.removeClass("add adding"),a.find("em, input").remove(),$('<span class="badge add">\n                  <span></span>\n                  <input type="text" name="" value="" tabindex="-1">\n                  <em>+</em>\n                </span>').appendTo(t.find(".trip-tags")).find("input").trigger("focus")):window.myTrips.methods.tags._cancel_element(a)}}}},window.myTrips.elements.trip.on("click",window.myTrips.methods._toggle),$("body").delegate(".trip .badge input","focus",window.myTrips.methods.tags._add),$("body").delegate(".trip .badge input","change paste keyup keydown",window.myTrips.methods.tags._keyup),$("body").delegate(".trip .badge em","click",window.myTrips.methods.tags._cancel)});